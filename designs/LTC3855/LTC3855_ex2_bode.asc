Version 4
SHEET 1 3608 1240
WIRE 208 -464 208 -480
WIRE -768 -384 -864 -384
WIRE -672 -384 -768 -384
WIRE -496 -384 -672 -384
WIRE 112 -384 -496 -384
WIRE 816 -384 112 -384
WIRE 208 -368 208 -400
WIRE 208 -368 -304 -368
WIRE 688 -368 208 -368
WIRE -864 -352 -864 -384
WIRE -672 -352 -672 -384
WIRE 592 -352 -192 -352
WIRE -496 -336 -496 -384
WIRE 496 -336 -96 -336
WIRE 816 -336 816 -384
WIRE -192 -320 -192 -352
WIRE -96 -320 -96 -336
WIRE 112 -320 112 -384
WIRE 208 -320 208 -368
WIRE 496 -320 496 -336
WIRE 592 -320 592 -352
WIRE -864 -256 -864 -272
WIRE -672 -256 -672 -288
WIRE -256 -256 -448 -256
WIRE 768 -256 656 -256
WIRE -304 -240 -304 -368
WIRE 688 -240 688 -368
WIRE -304 -160 -304 -176
WIRE -256 -160 -304 -160
WIRE 688 -160 688 -176
WIRE 688 -160 656 -160
WIRE -304 -144 -304 -160
WIRE 688 -144 688 -160
WIRE -1248 -64 -1408 -64
WIRE -1072 -64 -1248 -64
WIRE -912 -64 -1072 -64
WIRE -816 -64 -912 -64
WIRE -720 -64 -816 -64
WIRE -704 -64 -720 -64
WIRE -608 -64 -624 -64
WIRE -560 -64 -608 -64
WIRE -496 -64 -496 -240
WIRE -496 -64 -560 -64
WIRE -304 -64 -304 -80
WIRE -304 -64 -496 -64
WIRE -256 -64 -304 -64
WIRE 688 -64 688 -80
WIRE 688 -64 656 -64
WIRE 816 -64 816 -240
WIRE 816 -64 688 -64
WIRE 992 -64 816 -64
WIRE 1008 -64 992 -64
WIRE 1104 -64 1088 -64
WIRE 1168 -64 1104 -64
WIRE 1216 -64 1168 -64
WIRE -1408 -48 -1408 -64
WIRE -1248 -48 -1248 -64
WIRE -1072 -48 -1072 -64
WIRE -912 -48 -912 -64
WIRE -496 -48 -496 -64
WIRE 816 -48 816 -64
WIRE -256 32 -448 32
WIRE 768 32 656 32
WIRE -1408 48 -1408 32
WIRE -1248 48 -1248 32
WIRE -1072 48 -1072 16
WIRE -912 48 -912 16
WIRE -816 48 -816 -64
WIRE -816 64 -816 48
WIRE -496 64 -496 48
WIRE 816 64 816 48
WIRE -608 128 -608 -64
WIRE -592 128 -608 128
WIRE -432 128 -512 128
WIRE -304 128 -432 128
WIRE -256 128 -304 128
WIRE 688 128 656 128
WIRE 800 128 688 128
WIRE 896 128 800 128
WIRE 992 128 992 -64
WIRE 992 128 976 128
WIRE -304 144 -304 128
WIRE 688 144 688 128
WIRE -816 160 -816 144
WIRE -816 208 -816 160
WIRE -720 224 -720 -64
WIRE -432 224 -432 208
WIRE -432 224 -720 224
WIRE -304 224 -304 208
WIRE -304 224 -432 224
WIRE -256 224 -304 224
WIRE 688 224 688 208
WIRE 688 224 656 224
WIRE 800 224 800 208
WIRE 800 224 688 224
WIRE 1104 224 1104 -64
WIRE 1104 224 800 224
WIRE -816 320 -816 288
WIRE -304 320 -816 320
WIRE -256 320 -304 320
WIRE 688 320 656 320
WIRE 752 320 688 320
WIRE -816 336 -816 320
WIRE -576 416 -736 416
WIRE -304 416 -576 416
WIRE -256 416 -304 416
WIRE 688 416 656 416
WIRE 752 416 688 416
WIRE -736 432 -736 416
WIRE -816 448 -816 416
WIRE -576 480 -576 416
WIRE -736 512 -736 496
WIRE -304 512 -416 512
WIRE -256 512 -304 512
WIRE 688 512 656 512
WIRE 752 512 688 512
WIRE -416 528 -416 512
WIRE -736 608 -736 592
WIRE -656 608 -736 608
WIRE -576 608 -576 544
WIRE -576 608 -656 608
WIRE -304 608 -352 608
WIRE -256 608 -304 608
WIRE 704 608 656 608
WIRE 752 608 704 608
WIRE -416 624 -416 592
WIRE -656 640 -656 608
WIRE -256 704 -288 704
WIRE -288 736 -288 704
WIRE -128 784 -128 768
WIRE -32 784 -32 768
WIRE 160 784 160 768
WIRE 256 784 256 768
WIRE 304 784 256 784
WIRE 352 784 352 768
WIRE 352 784 304 784
WIRE 544 784 544 768
WIRE 304 800 304 784
WIRE -32 880 -32 864
FLAG 208 -480 0
FLAG 544 784 0
FLAG -128 784 0
FLAG 160 784 0
FLAG -32 880 0
FLAG -496 64 0
FLAG -416 624 0
FLAG -768 -384 IN
FLAG -864 -256 0
FLAG -912 48 0
FLAG -1072 48 0
FLAG -1248 48 0
FLAG -656 640 0
FLAG -288 736 0
FLAG -816 448 0
FLAG -672 -256 0
FLAG -1408 48 0
FLAG -304 416 C
FLAG -304 512 SS
FLAG -304 320 FB
FLAG -816 48 B
FLAG -816 160 A
FLAG -560 -64 D
FLAG 816 64 0
FLAG 688 416 C
FLAG 688 512 SS
FLAG 688 320 FB
FLAG 1168 -64 B
FLAG 704 608 TEMP
FLAG 304 800 0
FLAG -304 608 TEMP
SYMBOL PowerProducts\\LTC3855 208 224 R0
SYMATTR InstName U1
SYMBOL cap 192 -464 R0
SYMATTR InstName C3
SYMATTR Value 4.7
SYMBOL res -48 768 R0
SYMATTR InstName R6
SYMATTR Value 180k
SYMBOL nmos -448 -336 M0
WINDOW 0 -38 51 Left 2
WINDOW 3 31 107 Right 2
SYMATTR InstName Q1
SYMATTR Value RJK0305DPB
SYMBOL nmos -448 -48 M0
WINDOW 0 -36 57 Left 2
WINDOW 3 -149 103 Left 2
SYMATTR InstName Q2
SYMATTR Value RJK0301DPB
SYMBOL ind -608 -48 M270
WINDOW 0 108 54 VTop 2
WINDOW 3 104 54 VBottom 2
WINDOW 39 43 51 VTop 2
SYMATTR InstName L1
SYMATTR Value {L}
SYMATTR SpiceLine Rser={Rdcr}
SYMBOL cap -320 -144 R0
SYMATTR InstName C4
SYMATTR Value .1
SYMBOL schottky -288 -240 M0
WINDOW 0 8 0 Right 2
SYMATTR InstName D1
SYMATTR Value CMDSH2-3
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL cap -320 144 R0
WINDOW 0 -60 16 Left 2
WINDOW 3 -66 45 Left 2
SYMATTR InstName Cs1
SYMATTR Value {Cs}
SYMBOL res -608 112 M90
WINDOW 0 -34 51 VBottom 2
WINDOW 3 -35 52 VTop 2
SYMATTR InstName Rs1
SYMATTR Value {Rs}
SYMBOL cap -400 528 M0
WINDOW 0 47 35 Left 2
WINDOW 3 33 64 Left 2
SYMATTR InstName Css
SYMATTR Value 3600p
SYMBOL res -832 320 R0
WINDOW 0 -52 36 Left 2
WINDOW 3 -57 66 Left 2
SYMATTR InstName Rb
SYMATTR Value {Rb}
SYMBOL res -832 192 R0
WINDOW 0 -55 39 Left 2
WINDOW 3 -58 72 Left 2
SYMATTR InstName Ra
SYMATTR Value {Ra}
SYMBOL voltage -864 -368 R0
WINDOW 0 47 30 Left 2
WINDOW 3 40 58 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 43 90 Left 2
SYMATTR InstName Vin
SYMATTR Value {Vin}
SYMATTR SpiceLine Rser=10m
SYMBOL cap -928 -48 R0
WINDOW 39 -45 -67 Left 2
WINDOW 0 -10 -128 Left 2
WINDOW 3 -17 -98 Left 2
WINDOW 40 -36 -38 Left 2
SYMATTR SpiceLine Rser={Resr2}
SYMATTR InstName Cout2
SYMATTR Value {Cout2}
SYMATTR SpiceLine2 m={Mout2}
SYMBOL polcap -1088 -48 R0
WINDOW 39 -56 -69 Left 2
WINDOW 0 -17 -128 Left 2
WINDOW 3 -24 -99 Left 2
WINDOW 40 -45 -36 Left 2
SYMATTR SpiceLine Rser={Resr1}
SYMATTR InstName Cout1
SYMATTR Value {Cout1}
SYMATTR SpiceLine2 m={Mout1}
SYMBOL res -1264 -64 R0
WINDOW 0 45 45 Left 2
SYMATTR InstName Rload
SYMATTR Value {Rload}
SYMBOL cap -592 480 R0
WINDOW 0 52 15 Left 2
WINDOW 3 44 45 Left 2
SYMATTR InstName C2
SYMATTR Value {C2}
SYMBOL cap -752 432 R0
WINDOW 0 46 21 Left 2
WINDOW 3 38 52 Left 2
SYMATTR InstName C1
SYMATTR Value {C1}
SYMBOL res -752 496 R0
WINDOW 0 49 40 Left 2
WINDOW 3 42 69 Left 2
SYMATTR InstName R1
SYMATTR Value {R1}
SYMBOL cap -688 -352 R0
WINDOW 3 49 37 Left 2
WINDOW 0 48 12 Left 2
WINDOW 39 49 65 Left 2
SYMATTR Value 40
SYMATTR InstName Cin
SYMATTR SpiceLine Rser=10m
SYMBOL current -1408 -48 R0
WINDOW 3 -79 184 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 0 46 41 Left 2
SYMATTR Value PWL(0 0 1.2m 0 1.201m {Istep})
SYMATTR InstName Istep
SYMBOL res -416 112 M0
WINDOW 0 37 48 Left 2
SYMATTR InstName Ratten1
SYMATTR Value {Ratten}
SYMBOL VOLTAGE -816 160 R180
WINDOW 0 -77 105 Left 2
WINDOW 3 150 -80 Left 2
SYMATTR InstName Vsine
SYMATTR Value SINE(0 {if(freq<10k,50m,5m)} {freq})
SYMBOL nmos 768 -336 R0
WINDOW 0 59 51 Left 2
WINDOW 3 59 81 Left 2
SYMATTR InstName Q3
SYMATTR Value RJK0305DPB
SYMBOL nmos 768 -48 R0
WINDOW 0 91 35 Right 2
WINDOW 3 212 63 Right 2
SYMATTR InstName Q4
SYMATTR Value RJK0301DPB
SYMBOL ind 992 -48 R270
WINDOW 0 102 53 VTop 2
WINDOW 3 99 54 VBottom 2
WINDOW 39 43 58 VTop 2
SYMATTR InstName L2
SYMATTR Value {L}
SYMATTR SpiceLine Rser={Rdcr}
SYMBOL cap 672 -144 R0
SYMATTR InstName C5
SYMATTR Value .1
SYMBOL schottky 672 -240 R0
SYMATTR InstName D2
SYMATTR Value CMDSH2-3
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL cap 672 144 R0
WINDOW 0 45 20 Left 2
WINDOW 3 41 48 Left 2
SYMATTR InstName Cs2
SYMATTR Value {Cs}
SYMBOL res 992 112 R90
WINDOW 0 -37 56 VBottom 2
WINDOW 3 -36 53 VTop 2
SYMATTR InstName Rs2
SYMATTR Value {Rs}
SYMBOL res 784 112 R0
WINDOW 0 43 52 Left 2
WINDOW 3 41 80 Left 2
SYMATTR InstName Ratten2
SYMATTR Value {Ratten}
TEXT -1464 -96 Left 2 ;0.95V @ 40A
TEXT -1296 88 Left 2 ;static load
TEXT -1456 88 Left 2 ;load step
TEXT 0 888 Left 2 ;Rfreq = 120k for fsw = 500kHz\nRfreq = 180k for fsw = 750kHz
TEXT -1472 -1232 Left 4 ;LTC3855 Current-mode Synchronous Buck Controller Example #2
TEXT -1408 -1072 Left 3 ;The example power supply converts 12V to 0.95V @ 40A (dual-phase).\n \nThis example is based on the LTspice circuit downloaded from the\nLTC3855 page on Linear's web site. With the following modifications;\n * fsw increased from 350kHz to 750kHz\n * increased the soft-start time\n * single-output dual-phase controller
TEXT -1256 -1176 Left 3 ;6/20/2013 D. W. Hawkins (dwh@ovro.caltech.edu)
TEXT 1336 -1176 Left 2 !.param\n+ freq = 10k\n+ Vin = 12\n+ Vout = 0.95\n+ Iout = 40\n+ Irload = 2     ; Resistive load current\n+ Istep = (Iout-Irload)   ; Load step\n+ Rload = (Vout/Irload)\n+ L = 0.22u  ; IHLP-3232DZ-01\n+ Rdcr = 1.68m\n+ Vref = 0.6\n+ Ra = 10.2k   ; Vout = 0.952V\n+ Rb = 17.4k\n+ R1 = 20k\n+ C1 = 1500p\n+ C2 = 150p\n+ Cout1 = 1000u ; 470uF/6m 2R5TPF470M6L (POSCAP)\n+ Resr1 = 6m      ; or 1000uF/6m ETPF1000M6H\n+ Mout1 = 8\n+ Cout2 = 100u ; TDK C5750X5R0J107M (Ceramic)\n+ Resr2 = 2m\n+ Mout2 = 4\n+ Cs = 100n\n+ Rs = 1.3k\n+ Ratten = 5.23k
TEXT 1320 -1224 Left 3 ;Parameters:
TEXT 1328 224 Left 2 !.save V(a) V(b) V(c) V(d) I(L1)\n.option plotwinsize=0  ; turn off waveform compression\n.option option_angle=degrees\n.option nomarch=1 ; do not generate plots until done\n \n.measure Aavg avg V(a)\n.measure Bavg avg V(b)\n.measure Cavg avg V(c)\n.measure Davg avg V(d)\n.measure Are avg  (V(a)-Aavg)*cos(360*time*Freq)\n.measure Aim avg -(V(a)-Aavg)*sin(360*time*Freq)\n.measure Bre avg  (V(b)-Bavg)*cos(360*time*Freq)\n.measure Bim avg -(V(b)-Bavg)*sin(360*time*Freq)\n.measure Cre avg  (V(c)-Cavg)*cos(360*time*Freq)\n.measure Cim avg -(V(c)-Cavg)*sin(360*time*Freq)\n.measure Dre avg  (V(d)-Davg)*cos(360*time*Freq)\n.measure Dim avg -(V(d)-Davg)*sin(360*time*Freq)\n.measure Gain_dB param 20*log10(hypot(Bre,Bim) / hypot(Are,Aim))\n.measure Phase param mod(atan2(Bim, Bre) - atan2(Aim, Are)+180,360)-180\n.measure Kco_dB param 20*log10(hypot(Bre,Bim) / hypot(Cre,Cim))\n.measure Kco_Phase param mod(atan2(Bim, Bre) - atan2(Cim, Cre)+180,360)-180\n.measure Kcomp_dB param 20*log10(hypot(Cre,Cim) / hypot(Are,Aim))\n.measure Kcomp_Phase param mod(atan2(Cim, Cre) - atan2(Aim, Are)+180,360)-180\n.measure Kpwr_dB param 20*log10(hypot(Bre,Bim) / hypot(Dre,Dim))\n.measure Kpwr_Phase param mod(atan2(Bim, Bre) - atan2(Dim, Dre)+180,360)-180
TEXT 1328 128 Left 3 ;Gain and Phase Calculations:
TEXT 184 -1048 Left 2 !;.tran 0 {if(freq<10k,1.9m+10/freq,2.9m} startup
TEXT 160 -1080 Left 2 ;Transient response from time = 0
TEXT 160 -992 Left 2 ;Transient response from time = 1.9ms (after the load step has settled)
TEXT 192 -952 Left 2 !.tran 0 {if(freq<10k,1.9m+10/freq,2.9m} 1.9m startup
TEXT 192 -840 Left 2 ;To view the current load step transient response;\na) Comment out the .step command\nb) Change the .tran command to keep all the data\nc) (Optional) Change the sinusoid amplitude from 5m to 5p\nd) Create a plot with three panes containing V(b), V(c), and I(L1)\ne) (Optional) comment out the nomarch option to see the plot\n    waveforms updating during simulation\nf) (Optional) Comment out the .save command to view more signals
TEXT 136 -1232 Left 3 ;Analysis:
TEXT 176 -1176 Left 2 ;Use CTRL+right-mouse-click to (un)comment\none of these .tran commands
TEXT 160 -888 Left 3 ;Note:
TEXT 1344 -160 Left 2 !;.step param freq list  1k 2k 3k 4k 5k 7k 10k 20k 30k 50k 70k 100k 200k 300k 500k 700k 1Meg
TEXT 1328 -104 Left 2 ;Detailed response (the 100Hz and 300Hz measurements take a long time) (26 hours 56 minutes)
TEXT 1344 -240 Left 2 !.step param freq list  1k 3k 10k 30k 100k 300k 1Meg
TEXT 1328 -272 Left 2 ;Use this set of frequencies to get the coarse response reasonably quickly
TEXT 1312 -320 Left 3 ;Frequency sweep:
TEXT 1328 -192 Left 2 ;Use this set of frequencies for the detailed response (excluding the lowest frequencies)
TEXT 1344 -72 Left 2 !;.step param freq list 100 300 1k 2k 3k 4k 5k 7k 10k 20k 30k 50k 70k 100k 200k 300k 500k 700k 1Meg
LINE Normal -848 128 -944 224
RECTANGLE Normal 2488 1016 -1576 -1352
RECTANGLE Normal -128 -736 -1512 -1288
RECTANGLE Normal 2064 -432 1264 -1272
RECTANGLE Normal 2448 960 1280 40
RECTANGLE Normal 968 -584 88 -1280
RECTANGLE Normal 2448 0 1280 -360
